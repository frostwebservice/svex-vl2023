import{P as i,bF as W,bb as O,b2 as R,j as l,f as g,d as e,k as b,B as S,q as D,aZ as H,T as v,r as d,au as N,b_ as $,l as w,ci as I,G as _,bj as Q,bk as V,D as T,bl as X,bm as Z,bn as J,cq as K,c as Y,F as ee,S as te,u as re}from"./app-d2e90dc3.js";import{P as ne}from"./Plus-7d0037ac.js";import{o as ae}from"./index-a4818ce7.js";import{E as le}from"./Edit02-30df8b79.js";import{P as oe,a as x}from"./property-list-item-f3437f5e.js";import{S as B}from"./severity-pill-772ace92.js";import{T as M,b as E,c as y,a as G}from"./TableRow-5d8cde28.js";import{T as se}from"./TableHead-75b16b60.js";import{u as ie}from"./use-update-effect-b2b74886.js";import{T as ce}from"./TablePagination-a3981b5c.js";import"./deep-copy-ee95be26.js";import"./apply-pagination-03aa54c3.js";import"./apply-sort-ec30f364.js";const de={canceled:"warning",complete:"success",pending:"info",rejected:"error"},F=r=>{const{onApprove:t,onEdit:o,onReject:n,order:a}=r,s=W(h=>h.breakpoints.up("lg"))?"horizontal":"vertical",p=a.items||[],u=O(a.createdAt,"dd/MM/yyyy HH:mm"),f=de[a.status],C=R(a.totalAmount).format(`${a.currency}0,0.00`);return l(g,{spacing:6,children:[l(g,{spacing:3,children:[l(g,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:3,children:[e(b,{variant:"h6",children:"Details"}),e(S,{color:"inherit",onClick:o,size:"small",startIcon:e(D,{children:e(le,{})}),children:"Edit"})]}),l(oe,{children:[e(x,{align:s,disableGutters:!0,divider:!0,label:"ID",value:a.id}),e(x,{align:s,disableGutters:!0,divider:!0,label:"Number",value:a.number}),l(x,{align:s,disableGutters:!0,divider:!0,label:"Customer",children:[e(b,{color:"text.secondary",variant:"body2",children:a.customer.name}),e(b,{color:"text.secondary",variant:"body2",children:a.customer.address1}),e(b,{color:"text.secondary",variant:"body2",children:a.customer.city}),e(b,{color:"text.secondary",variant:"body2",children:a.customer.country})]}),e(x,{align:s,disableGutters:!0,divider:!0,label:"Date",value:u}),e(x,{align:s,disableGutters:!0,divider:!0,label:"Promotion Code",value:a.promotionCode}),e(x,{align:s,disableGutters:!0,divider:!0,label:"Total Amount",value:C}),e(x,{align:s,disableGutters:!0,divider:!0,label:"Status",children:e(B,{color:f,children:a.status})})]}),l(g,{alignItems:"center",direction:"row",flexWrap:"wrap",justifyContent:"flex-end",spacing:2,children:[e(S,{onClick:t,size:"small",variant:"contained",children:"Approve"}),e(S,{color:"error",onClick:n,size:"small",variant:"outlined",children:"Reject"})]})]}),l(g,{spacing:3,children:[e(b,{variant:"h6",children:"Line items"}),e(H,{children:l(M,{sx:{minWidth:400},children:[e(se,{children:l(E,{children:[e(y,{children:"Description"}),e(y,{children:"Billing Cycle"}),e(y,{children:"Amount"})]})}),e(G,{children:p.map(h=>{const k=R(h.unitAmount).format(`${h.currency}0,0.00`);return l(E,{children:[l(y,{children:[h.name," ","x"," ",h.quantity]}),e(y,{children:h.billingCycle}),e(y,{children:k})]},h.id)})})]})})]})]})};F.propTypes={onApprove:i.func,onEdit:i.func,onReject:i.func,order:i.object};const ue=[{label:"Canceled",value:"canceled"},{label:"Complete",value:"complete"},{label:"Pending",value:"pending"},{label:"Rejected",value:"rejected"}],L=r=>{const{onCancel:t,onSave:o,order:n}=r,a=O(n.createdAt,"dd/MM/yyyy HH:mm");return e(g,{spacing:6,children:l(g,{spacing:3,children:[e(b,{variant:"h6",children:"Details"}),l(g,{spacing:3,children:[e(v,{disabled:!0,fullWidth:!0,label:"ID",name:"id",value:n.id}),e(v,{disabled:!0,fullWidth:!0,label:"Number",name:"number",value:n.number}),e(v,{disabled:!0,fullWidth:!0,label:"Customer name",name:"customer_name",value:n.customer.name}),e(v,{disabled:!0,fullWidth:!0,label:"Date",name:"date",value:a}),e(v,{fullWidth:!0,label:"Address",name:"address",value:n.customer.address1}),e(v,{fullWidth:!0,label:"Country",name:"country",value:n.customer.country}),e(v,{fullWidth:!0,label:"State/Region",name:"state_region",value:n.customer.city}),e(v,{fullWidth:!0,label:"Total Amount",name:"amount",value:n.totalAmount}),e(v,{fullWidth:!0,label:"Status",name:"status",select:!0,SelectProps:{native:!0},value:n.status,children:ue.map(c=>e("option",{value:c.value,children:c.label},c.value))})]}),l(g,{alignItems:"center",direction:"row",flexWrap:"wrap",spacing:2,children:[e(S,{color:"primary",onClick:o,size:"small",variant:"contained",children:"Save changes"}),e(S,{color:"inherit",onClick:t,size:"small",children:"Cancel"})]})]})})};L.propTypes={onCancel:i.func,onSave:i.func,order:i.object};const q=r=>{const{container:t,onClose:o,open:n,order:a}=r,[c,s]=d.useState(!1),p=W(h=>h.breakpoints.up("lg")),u=d.useCallback(()=>{s(!0)},[]),f=d.useCallback(()=>{s(!1)},[]);let C=null;return a&&(C=l("div",{children:[l(g,{alignItems:"center",direction:"row",justifyContent:"space-between",sx:{px:3,py:2},children:[e(b,{color:"inherit",variant:"h6",children:a.number}),e(N,{color:"inherit",onClick:o,children:e(D,{children:e($,{})})})]}),e(w,{sx:{px:3,py:4},children:c?e(L,{onCancel:f,onSave:f,order:a}):e(F,{onApprove:o,onEdit:u,onReject:o,order:a})})]})),p?e(I,{anchor:"right",open:n,PaperProps:{sx:{position:"relative",width:500}},SlideProps:{container:t},variant:"persistent",children:C}):e(I,{anchor:"left",hideBackdrop:!0,ModalProps:{container:t,sx:{pointerEvents:"none",position:"absolute"}},onClose:o,open:n,PaperProps:{sx:{maxWidth:"100%",width:400,pointerEvents:"auto",position:"absolute"}},SlideProps:{container:t},variant:"temporary",children:C})};q.propTypes={container:i.any,onClose:i.func,open:i.bool,order:i.object};const pe=_("div",{shouldForwardProp:r=>r!=="open"})(({theme:r,open:t})=>({flexGrow:1,overflow:"auto",zIndex:1,[r.breakpoints.up("lg")]:{marginRight:-500},transition:r.transitions.create("margin",{easing:r.transitions.easing.sharp,duration:r.transitions.duration.leavingScreen}),...t&&{[r.breakpoints.up("lg")]:{marginRight:0},transition:r.transitions.create("margin",{easing:r.transitions.easing.easeOut,duration:r.transitions.duration.enteringScreen})}})),he=[{label:"All",value:"all"},{label:"Canceled",value:"canceled"},{label:"Completed",value:"complete"},{label:"Pending",value:"pending"},{label:"Rejected",value:"rejected"}],me=[{label:"Newest",value:"desc"},{label:"Oldest",value:"asc"}],z=r=>{const{onFiltersChange:t,onSortChange:o,sortDir:n="asc"}=r,a=d.useRef(null),[c,s]=d.useState("all"),[p,u]=d.useState({query:void 0,status:void 0}),f=d.useCallback(()=>{t==null||t(p)},[p,t]);ie(()=>{f()},[p,f]);const C=d.useCallback((m,P)=>{s(P);const A=P==="all"?void 0:P;u(j=>({...j,status:A}))},[]),h=d.useCallback(m=>{var A;m.preventDefault();const P=((A=a.current)==null?void 0:A.value)||"";u(j=>({...j,query:P}))},[]),k=d.useCallback(m=>{const P=m.target.value;o==null||o(P)},[o]);return l("div",{children:[e(Q,{indicatorColor:"primary",onChange:C,scrollButtons:"auto",sx:{px:3},textColor:"primary",value:c,variant:"scrollable",children:he.map(m=>e(V,{label:m.label,value:m.value},m.value))}),e(T,{}),l(g,{alignItems:"center",direction:"row",flexWrap:"wrap",gap:3,sx:{p:3},children:[e(w,{component:"form",onSubmit:h,sx:{flexGrow:1},children:e(X,{defaultValue:"",fullWidth:!0,inputProps:{ref:a},name:"orderNumber",placeholder:"Search by order number",startAdornment:e(Z,{position:"start",children:e(D,{children:e(J,{})})})})}),e(v,{label:"Sort By",name:"sort",onChange:k,select:!0,SelectProps:{native:!0},value:n,children:me.map(m=>e("option",{value:m.value,children:m.label},m.value))})]})]})};z.propTypes={onFiltersChange:i.func,onSortChange:i.func,sortBy:i.string,sortDir:i.oneOf(["asc","desc"])};const be={complete:"success",pending:"info",canceled:"warning",rejected:"error"},U=r=>{const{count:t=0,items:o=[],onPageChange:n=()=>{},onRowsPerPageChange:a,onSelect:c,page:s=0,rowsPerPage:p=0}=r;return l("div",{children:[e(M,{children:e(G,{children:o.map(u=>{const f=O(u.createdAt,"LLL").toUpperCase(),C=O(u.createdAt,"d"),h=R(u.totalAmount).format(`${u.currency}0,0.00`),k=be[u.status]||"warning";return l(E,{hover:!0,onClick:()=>c==null?void 0:c(u.id),sx:{cursor:"pointer"},children:[l(y,{sx:{alignItems:"center",display:"flex"},children:[l(w,{sx:{backgroundColor:m=>m.palette.mode==="dark"?"neutral.800":"neutral.200",borderRadius:2,maxWidth:"fit-content",ml:3,p:1},children:[e(b,{align:"center",variant:"subtitle2",children:f}),e(b,{align:"center",variant:"h6",children:C})]}),l(w,{sx:{ml:2},children:[e(b,{variant:"subtitle2",children:u.number}),l(b,{color:"text.secondary",variant:"body2",children:["Total of"," ",h]})]})]}),e(y,{align:"right",children:e(B,{color:k,children:u.status})})]},u.id)})})}),e(ce,{component:"div",count:t,onPageChange:n,onRowsPerPageChange:a,page:s,rowsPerPage:p,rowsPerPageOptions:[5,10,25]})]})};U.propTypes={count:i.number,items:i.array,onPageChange:i.func,onRowsPerPageChange:i.func,onSelect:i.func,page:i.number,rowsPerPage:i.number};const ge=()=>{const[r,t]=d.useState({filters:{query:void 0,status:void 0},page:0,rowsPerPage:5,sortBy:"createdAt",sortDir:"desc"}),o=d.useCallback(s=>{t(p=>({...p,filters:s}))},[]),n=d.useCallback(s=>{t(p=>({...p,sortDir:s}))},[]),a=d.useCallback((s,p)=>{t(u=>({...u,page:p}))},[]),c=d.useCallback(s=>{t(p=>({...p,rowsPerPage:parseInt(s.target.value,10)}))},[]);return{handleFiltersChange:o,handleSortChange:n,handlePageChange:a,handleRowsPerPageChange:c,state:r}},ve=r=>{const t=re(),[o,n]=d.useState({orders:[],ordersCount:0}),a=d.useCallback(async()=>{try{const c=await ae.getOrders(r);t()&&n({orders:c.data,ordersCount:c.count})}catch(c){console.error(c)}},[r,t]);return d.useEffect(()=>{a()},[r]),{...o}},fe=(r,t)=>d.useMemo(()=>{if(t)return r.find(o=>o.id===t)},[r,t]),Ee=()=>{const r=d.useRef(null),t=ge(),o=ve(t.state),n=K(),a=fe(o.orders,n.data);Y();const c=d.useCallback(s=>{if(n.open&&n.data===s){n.handleClose();return}n.handleOpen(s)},[n]);return l(ee,{children:[e(te,{title:"Dashboard: Order List"}),e(T,{}),e(w,{component:"main",ref:r,sx:{display:"flex",flex:"1 1 auto",overflow:"hidden",position:"relative"},children:l(w,{ref:r,sx:{bottom:0,display:"flex",left:0,position:"absolute",right:0,top:0},children:[l(pe,{open:n.open,children:[e(w,{sx:{p:3},children:l(g,{alignItems:"flex-start",direction:"row",justifyContent:"space-between",spacing:4,children:[e("div",{children:e(b,{variant:"h4",children:"Orders"})}),e("div",{children:e(S,{startIcon:e(D,{children:e(ne,{})}),variant:"contained",children:"Add"})})]})}),e(T,{}),e(z,{onFiltersChange:t.handleFiltersChange,onSortChange:t.handleSortChange,sortBy:t.state.sortBy,sortDir:t.state.sortDir}),e(T,{}),e(U,{count:o.ordersCount,items:o.orders,onPageChange:t.handlePageChange,onRowsPerPageChange:t.handleRowsPerPageChange,onSelect:c,page:t.state.page,rowsPerPage:t.state.rowsPerPage})]}),e(q,{container:r.current,onClose:n.handleClose,open:n.open,order:a})]})})]})};export{Ee as default};
